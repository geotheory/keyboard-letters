<html>
  <title>Keyboard Letters Game</title>
  <style>
  html, body {
      width: 100%;
      height: 100%;
      padding: 0;
      margin: 0;
      overflow: hidden;
  }
  body {
      background: DARKGREY;
      font-family: Verdana, Helvetica, Arial, sans-serif;
  }
  span.letter {
      font-size: 16em;
      font-weight: bold;
      /*text-shadow: 8px 8px 11px rgba(150, 150, 150, 0.74);*/
      text-shadow: -5px 0 black, 0 5px black, 5px 0 black, 0 -5px black;
      z-index:-99;
  }
  span.image {
      border: solid black 5px;
      background: WHITE;
      z-index:-99;
  }
  #instructions {
      font-size: 1.2em;
      color: WHITE;
      padding:20px;
      text-align:center;
  }
  select {
      background: DARKGREY;
      border:1px #444444 solid;
  }
  #settingsPanel {
      background: DARKGREY;
      z-index:99;
      position: absolute;
      right:8px;
      bottom:8px;
      padding:2px;
      font-size:0.8em;
  }
  #infoAndCredits {
      z-index:99;
      position: absolute;
      left:8px;
      bottom:8px;
      padding:2px;
      font-size:0.8em;
  }
  #credits {
      font-size:0.7em;
  }|
  </style>
  <script>
    var allLetters = '';
    var allElements = [];
    var keyheld = false;
    var voice = null;
    var voices = null;
    var mode = null;
    var timer = null;

    var words = {
        "A": {word: "Apple",      image: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Fuji_apple.jpg/320px-Fuji_apple.jpg" },
        "B": {word: "Ball",       image: "https://upload.wikimedia.org/wikipedia/commons/7/7f/Generic_football.png" },
        "C": {word: "Cat",        image: "https://upload.wikimedia.org/wikipedia/commons/thumb/d/da/Black_hills_cat-tochichi.jpg/320px-Black_hills_cat-tochichi.jpg" },
        "D": {word: "Dog",        image: "https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Siberian_husky1.JPG/320px-Siberian_husky1.JPG" },
        "E": {word: "Egg",        image: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/Natural_Easter_Colored_Eggs.jpg/320px-Natural_Easter_Colored_Eggs.jpg" },
        "F": {word: "Fish",       image: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/Pseudorasbora_parva%28edited_version%29.jpg/320px-Pseudorasbora_parva%28edited_version%29.jpg" },
        "G": {word: "Gate",       image: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/15/Hargimont_051030_%285%29.JPG/320px-Hargimont_051030_%285%29.JPG" },
        "H": {word: "Horse",      image: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/Bess2.jpg/279px-Bess2.jpg" },
        "I": {word: "Igloo",      image: "https://upload.wikimedia.org/wikipedia/commons/9/99/Igloo_outside.jpg" },
        "J": {word: "Jam",        image: "https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/Marmeladesorten.jpg/320px-Marmeladesorten.jpg" },
        "K": {word: "Kangaroo",   image: "https://upload.wikimedia.org/wikipedia/commons/thumb/b/b9/Kangaroo1.jpg/210px-Kangaroo1.jpg" },
        "L": {word: "Lion",       image: "https://upload.wikimedia.org/wikipedia/commons/thumb/2/2c/Lion-1.jpg/320px-Lion-1.jpg" },
        "M": {word: "Mouse",      image: "https://upload.wikimedia.org/wikipedia/commons/thumb/b/bd/Apodemus_sylvaticus_bosmuis.jpg/320px-Apodemus_sylvaticus_bosmuis.jpg" },
        "N": {word: "Nest",       image: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Hausrotschwanz_Brutpflege_2006-05-24_211.jpg/320px-Hausrotschwanz_Brutpflege_2006-05-24_211.jpg" },
        "O": {word: "Octopus",    image: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/ee/Expl0717_-_Flickr_-_NOAA_Photo_Library.jpg/320px-Expl0717_-_Flickr_-_NOAA_Photo_Library.jpg" },
        "P": {word: "Parrot",     image: "https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/Rose-ringed_Parakeet_%28Psittacula_krameri%29_-male2.jpg/201px-Rose-ringed_Parakeet_%28Psittacula_krameri%29_-male2.jpg" },
        "Q": {word: "Queen",      image: "https://upload.wikimedia.org/wikipedia/commons/9/9c/Queen_Victoria_1887.jpg" },
        "R": {word: "Rabbit",     image: "https://upload.wikimedia.org/wikipedia/commons/4/48/American_Grand_Champion_Dutch_Rabbit.jpg" },
        "S": {word: "Sun",        image: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/7c/April_dawn.jpg/500px-April_dawn.jpg" },
        "T": {word: "Turtle",     image: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/1e/Sea_Turtle.jpg/500px-Sea_Turtle.jpg" },
        "U": {word: "Umbrella",   image: "https://upload.wikimedia.org/wikipedia/commons/0/06/Umbrella.png" },
        "V": {word: "Volcano",    image: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Augustine_Volcano_Jan_12_2006.jpg/500px-Augustine_Volcano_Jan_12_2006.jpg" },
        "W": {word: "Window",     image: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6a/Gordijnen_aan_venster.JPG/500px-Gordijnen_aan_venster.JPG" },
        "X": {word: "Xylophone",  image: "https://upload.wikimedia.org/wikipedia/commons/thumb/f/f7/Toy_xylophone.jpg/500px-Toy_xylophone.jpg" },
        "Y": {word: "Yo yo",      image: "https://upload.wikimedia.org/wikipedia/commons/9/92/Wooden_yo-yo.jpg" },
        "Z": {word: "Zebra",      image: "https://upload.wikimedia.org/wikipedia/commons/5/53/Zebra_rownikowa_Equus_burchelli_boehmi_RB3.jpg" }
    };

    var animals = {
        'CAT': 'mee-ow!',
        'DOG': 'woof!',
        'COW': 'moo!',
        'FROG': 'croak',
        'BEE': 'buzz',
        'TURKEY': 'gobble!',
        'PIG': 'oink!',
        'SHEEP': 'baa!'
    };

    function init() {
        initMode();

        timer = setInterval(function() {
            voices = speechSynthesis.getVoices();
            if (voices.length !== 0) {
                voice = setVoice();
                clearInterval(timer);
            }
        }, 200);
    }
    window.speechSynthesis.onvoiceschanged = function() {
        voice = setVoice();
    };

    document.onkeyup = function(e) {
        keyheld = false;
    }

    document.onkeypress = function(e) {
        e = e || window.event;
        var charCode = (typeof e.which == "number") ? e.which : e.keyCode;
        if (charCode && !keyheld) {
            var text = String.fromCharCode(charCode).toUpperCase();
            doLetter(text);
        }
    };

    function doLetter(letter) {
        document.getElementById('instructions').style.display = 'none';
        text = letter;

        if (mode=='words' || mode=='letter-is-for-word') {
            for (var searchLetter in words) {
                wordData = words[searchLetter];

                if (letter==searchLetter) {
                    text = wordData.word;
                    if (mode=='letter-is-for-word') {
                        text = letter + ", is for, " + text;
                    }
                    showImage(wordData.image);
                }
            }
        }

        say(text.toLowerCase());

        allLetters += letter;

        for (animal in animals) {
            if(allLetters.endsWith(animal)) say(animals[animal]);
        }

        drawColourfulText(letter);

        keyheld = true;

        truncate();
    }

    function drawColourfulText(text) {
        var elem = document.createElement("span");
        elem.setAttribute("class", "letter");
        elem.textContent = text;
        elem.style.position = "absolute";

        document.body.appendChild(elem);
        var x = Math.round(Math.random() * (window.innerWidth - elem.clientWidth));
        var y = Math.round(Math.random() * (window.innerHeight - (elem.clientHeight - 100))) - 70;

        elem.style.left = x + "px";
        elem.style.top = y + "px";
        elem.style.color = randomLightColour(); //colours[Math.floor(Math.random()*colours.length)];
        allElements.push(elem);
    }

    document.onclick = function() {
        if (allLetters=='') allLetters='@'; // before start of the alphabet
        lastLetter = allLetters[allLetters.length -1];
        nextLetter = String.fromCharCode(lastLetter.charCodeAt(0) + 1)
        if (lastLetter == 'Z') {
            say('alphabet!');
            allLetters = '';
        } else if (lastLetter == '9') {
            doLetter('10');
        } else {
            doLetter(nextLetter);
        }
    };

    function truncate() {
        var maxLenParam = getParameterByName('maxlen');
        if (maxLenParam == null) return;
        var maxLength = parseInt(maxLenParam || '50');
        if (maxLength < 1) return;
        if (mode=='words') maxLength = maxLength * 2;

        // Clean up so that there are only a certain amount of letters on screen.
        while (allElements.length > maxLength) {
            var removed = allElements.shift();
            document.body.removeChild(removed);
        }
        if (allLetters.length > allElements.length) {
            allLetters = allLetters.substring(allLetters.length - allElements.length);
        }
    }

    function say(text) {
        if (getParameterByName('voice') != 'None') {
            var utterance = new SpeechSynthesisUtterance(text);
            if (voice==null) voice=setVoice();
            if (voice!=null) utterance.voice = voice
            window.speechSynthesis.speak(utterance);
        }
    }

    function showImage(imageURL) {
        if (imageURL=='') return;

        var elem = document.createElement("span");
        elem.setAttribute("class", "image");
        elem.innerHTML = "<img src='" + imageURL + "'>";
        elem.style.position = "absolute";
        document.body.appendChild(elem);


        var x = Math.round(Math.random() * (window.innerWidth - elem.clientWidth));
        var y = Math.round(Math.random() * (window.innerHeight - elem.clientHeight));

        elem.style.left = x + "px";
        elem.style.top = y + "px";

        allElements.push(elem);

        document.getElementById('credits').innerHTML = "Open licensed images via <a href='https://en.wikibooks.org/wiki/Wikijunior:Alphabet'>WikiBooks.org Alphabet</a>";
    }

    function setVoice() {
        var langParam = getParameterByName('lang');
        var voiceName = getParameterByName('voice');
        var lang = langParam
        if (langParam==null && voiceName==null) {
            //Get browser langauge
            lang = navigator.languages ? navigator.languages[0] : (navigator.language || navigator.userLanguage)
        }

        if (lang!==null) lang=lang.toLowerCase();

        voices = window.speechSynthesis.getVoices();
        var found = null;
        var availableLangs = [];
        var voicesByName = {};
        for (var i=0; i<voices.length; i++) {
            var v = voices[i];
            if (availableLangs.indexOf(v.lang) == -1) availableLangs.push(v.lang);
            voicesByName[v.name] = v.lang;
            if (found == null) {
                if (v.name==voiceName) found = v;
                if (v.lang.toLowerCase()==lang) found = v;
            }
        }
        if (voiceName=='None') {
            updateVoiceChoice(voicesByName, 'None');
            return null;
        }
        if (found==null) {
            if (window.langParameter && lang!=null) {
                alert('No voice for lang ' + lang + "\n\n" +
                      'Available langs: ' + availableLangs.join());
            }
            if (voiceName!=null) alert('No voice for with name ' + voiceName);
            found = voices[0];
        }

        updateVoiceChoice(voicesByName, found.name);
        return found;

    }

    function updateVoiceChoice(voicesByName, selectedName) {
        elem = document.getElementById('voicePicker');

        names = Object.keys(voicesByName);
        names.push('None');

        optionTags  = '';
        for (var i=0; i<names.length; i++) {
            sel = '';
            if (names[i]==selectedName) sel='selected';
            optionTags += '<option value="' + names[i] + '" ' + sel + '>' + names[i] + '</option>';
        }
        elem.innerHTML = optionTags;
    }

    function voicePicked(elem) {
        reloadSettings();
    }

    function modePicked(elem) {
        mode = elem.value;
        reloadSettings();
    }

    function reloadSettings() {
        var voiceName = document.getElementById('voicePicker').value;
        window.location = "?mode=" + mode + "&voice=" + encodeURI(voiceName);
    }

    function initMode() {
        mode = getParameterByName('mode');
        if (mode==null) mode = 'letters';
        document.getElementById('modePicker').value = mode;
    }

    function randomLightColour() {
        var hue = Math.random() * 360;
        var saturation = 100;
        var varience = 50;
        return 'hsl(' + hue + ', ' + saturation + '%, ' + varience + '%)';
    }

    // http://stackoverflow.com/a/901144/338265
    function getParameterByName(name) {
        var url = window.location.href;
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, " "));
    }
  </script>
</html>
<body onLoad="init();">

<div id="settingsPanel">
  <label for="voicePicker">Voice:</label>
  <select id="voicePicker" onChange="voicePicked(this);">
    <option value="Alex">Alex</option>
    <option value="None">None</option>
  </select>

  <label for="modePicker">Mode:</label>
  <select id="modePicker" onChange="modePicked(this);">
    <option value="letters">letters</option>
    <option value="words">words</option>
    <option value="letter-is-for-word">letter is for word</option>
  </select>
</div>

<div id="instructions">
   If you are a baby, whack your keyboard randomly now
</div>

<div id="infoAndCredits">
   (<a href="//harrywood.co.uk/blog/2016/09/10/keyboard-letters-game/" title="Blog post about this">About</a>)
   <span id="credits">
   </span>
</div>
</body>
</html>
